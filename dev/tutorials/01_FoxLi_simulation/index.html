<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>FoxLi simulation · FluxOptics.jl</title><meta name="title" content="FoxLi simulation · FluxOptics.jl"/><meta property="og:title" content="FoxLi simulation · FluxOptics.jl"/><meta property="twitter:title" content="FoxLi simulation · FluxOptics.jl"/><meta name="description" content="Documentation for FluxOptics.jl."/><meta property="og:description" content="Documentation for FluxOptics.jl."/><meta property="twitter:description" content="Documentation for FluxOptics.jl."/><meta property="og:url" content="https://anscoil.github.io/FluxOptics.jl/tutorials/01_FoxLi_simulation/"/><meta property="twitter:url" content="https://anscoil.github.io/FluxOptics.jl/tutorials/01_FoxLi_simulation/"/><link rel="canonical" href="https://anscoil.github.io/FluxOptics.jl/tutorials/01_FoxLi_simulation/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="FluxOptics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FluxOptics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>FoxLi simulation</a><ul class="internal"><li><a class="tocitem" href="#Physical-Setup"><span>Physical Setup</span></a></li><li><a class="tocitem" href="#Initial-Field:-Speckle-Pattern"><span>Initial Field: Speckle Pattern</span></a></li><li><a class="tocitem" href="#Gain-Medium-Configuration"><span>Gain Medium Configuration</span></a></li><li><a class="tocitem" href="#Cavity-Geometry:-Semi-Degenerate-Configuration"><span>Cavity Geometry: Semi-Degenerate Configuration</span></a></li><li><a class="tocitem" href="#Output-Coupler:-Spherical-Mirror-with-Aperture"><span>Output Coupler: Spherical Mirror with Aperture</span></a></li><li><a class="tocitem" href="#Fox-Li-Iteration:-Eigenmode-Convergence"><span>Fox-Li Iteration: Eigenmode Convergence</span></a></li><li><a class="tocitem" href="#Converged-Eigenmode:-Quasi-Ince-Gaussian-IGᵉ"><span>Converged Eigenmode: Quasi-Ince-Gaussian IGᵉ₉₃</span></a></li><li><a class="tocitem" href="#Far-Field-Characterization"><span>Far-Field Characterization</span></a></li></ul></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../api/">API Reference</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">GridUtils</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/gridutils/">GridUtils</a></li><li><a class="tocitem" href="../../api/gridutils/gridutils/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Modes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/modes/">Modes</a></li><li><a class="tocitem" href="../../api/modes/modes/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-4" type="checkbox"/><label class="tocitem" for="menuitem-3-4"><span class="docs-label">Fields</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/fields/">Fields</a></li><li><a class="tocitem" href="../../api/fields/fields/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5"><span class="docs-label">Optical Components</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/">Optical Components</a></li><li><input class="collapse-toggle" id="menuitem-3-5-2" type="checkbox"/><label class="tocitem" for="menuitem-3-5-2"><span class="docs-label">Core</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/core/">Core</a></li><li><a class="tocitem" href="../../api/optical_components/core/core/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-3" type="checkbox"/><label class="tocitem" for="menuitem-3-5-3"><span class="docs-label">Sources</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/sources/">Sources</a></li><li><a class="tocitem" href="../../api/optical_components/sources/sources/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-4" type="checkbox"/><label class="tocitem" for="menuitem-3-5-4"><span class="docs-label">Modulators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/modulators/">Modulators</a></li><li><a class="tocitem" href="../../api/optical_components/modulators/modulators/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-5" type="checkbox"/><label class="tocitem" for="menuitem-3-5-5"><span class="docs-label">Fourier</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/fourier/">Fourier</a></li><li><a class="tocitem" href="../../api/optical_components/fourier/fourier/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-6" type="checkbox"/><label class="tocitem" for="menuitem-3-5-6"><span class="docs-label">Utilities</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/utilities/">Utilities</a></li><li><a class="tocitem" href="../../api/optical_components/utilities/utilities/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-7" type="checkbox"/><label class="tocitem" for="menuitem-3-5-7"><span class="docs-label">Free-Space Propagators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/freespace/">Free-Space Propagators</a></li><li><a class="tocitem" href="../../api/optical_components/freespace/freespace/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-8" type="checkbox"/><label class="tocitem" for="menuitem-3-5-8"><span class="docs-label">Bulk Propagators</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/bulk/">Bulk Propagators</a></li><li><a class="tocitem" href="../../api/optical_components/bulk/bulk/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-9" type="checkbox"/><label class="tocitem" for="menuitem-3-5-9"><span class="docs-label">Active Media</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/active/">Active Media</a></li><li><a class="tocitem" href="../../api/optical_components/active/active_media/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-5-10" type="checkbox"/><label class="tocitem" for="menuitem-3-5-10"><span class="docs-label">System</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optical_components/system/">System</a></li><li><a class="tocitem" href="../../api/optical_components/system/system/">API</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">OptimisersExt</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/optimisers/">OptimisersExt</a></li><li><a class="tocitem" href="../../api/optimisers/optimisers/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Metrics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/metrics/">Metrics</a></li><li><a class="tocitem" href="../../api/metrics/metrics/">API</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Plotting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/plotting/">Plotting</a></li><li><a class="tocitem" href="../../api/plotting/plotting/">API</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>FoxLi simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>FoxLi simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/anscoil/FluxOptics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/anscoil/FluxOptics.jl/blob/main/docs/src/tutorials/01_FoxLi_simulation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fox-Li-Cavity-Simulation:-Quasi-Ince-Gaussian-Mode-Formation"><a class="docs-heading-anchor" href="#Fox-Li-Cavity-Simulation:-Quasi-Ince-Gaussian-Mode-Formation">Fox-Li Cavity Simulation: Quasi-Ince-Gaussian Mode Formation</a><a id="Fox-Li-Cavity-Simulation:-Quasi-Ince-Gaussian-Mode-Formation-1"></a><a class="docs-heading-anchor-permalink" href="#Fox-Li-Cavity-Simulation:-Quasi-Ince-Gaussian-Mode-Formation" title="Permalink"></a></h1><p>This tutorial demonstrates the Fox-Li iterative method for finding cavity eigenmodes in a semi-degenerate laser resonator configuration. Under specific conditions, the cavity supports <strong>quasi-Ince-Gaussian modes</strong> (quasi-IGᵉ₉₃ in this case) - modes that are nearly invariant under propagation despite not being true IG eigenmodes.</p><blockquote><p><strong>Quasi-IG vs True IG Modes</strong></p><p>True Ince-Gaussian modes with closed nodal lines cannot be excited with single-lobe pumping away from degeneracy: there will always exist a mode without closed nodal lines that has better overlap with the pump (gain-matching criterion). The quasi-IG patterns observed here only emerge near cavity degeneracies.</p><p>For details, see: N. Barré, M. Romanelli, and M. Brunel, <a href="https://doi.org/10.1364/OL.39.001022">&quot;Role of cavity degeneracy for high-order mode excitation in end-pumped solid-state lasers&quot;</a>, Opt. Lett. <strong>39</strong>, 1022-1025 (2014).</p></blockquote><h2 id="Physical-Setup"><a class="docs-heading-anchor" href="#Physical-Setup">Physical Setup</a><a id="Physical-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Setup" title="Permalink"></a></h2><p>We simulate a laser cavity with:</p><ul><li>A flat mirror with gain medium (near field)</li><li>A curved output coupler with aperture (far field)</li><li>Cavity length close to the stability boundary (semi-degenerate)</li></ul><p>The Fox-Li method iteratively propagates the field through the cavity until convergence to the eigenmode.</p><pre><code class="language-julia hljs">using FluxOptics, CairoMakie
using Random
Random.seed!(15);  # Determinist example</code></pre><h2 id="Initial-Field:-Speckle-Pattern"><a class="docs-heading-anchor" href="#Initial-Field:-Speckle-Pattern">Initial Field: Speckle Pattern</a><a id="Initial-Field:-Speckle-Pattern-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Field:-Speckle-Pattern" title="Permalink"></a></h2><p>We start with a random speckle pattern as initial condition. This generic field contains contributions from all cavity modes - the iterative process will select the dominant eigenmode through preferential amplification.</p><pre><code class="language-julia hljs">ns = 512, 512
ds = 4.0, 4.0

λ = 1.064
NA = 0.01

w0 = 500.0

speckle_dist = generate_speckle(ns, ds, λ, NA; envelope = Gaussian(w0))
u0 = ScalarField(speckle_dist, ds, λ)
normalize_power!(u0, 1e-1)

visualize(u0, (intensity, complex); colormap=(:inferno, :dark), height=120)</code></pre><p><img src="../../assets/01_FoxLi_speckle.png" alt="Initial speckle field with Gaussian envelope"/></p><h2 id="Gain-Medium-Configuration"><a class="docs-heading-anchor" href="#Gain-Medium-Configuration">Gain Medium Configuration</a><a id="Gain-Medium-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Gain-Medium-Configuration" title="Permalink"></a></h2><p>The gain sheet provides selective amplification with saturable gain dynamics. The off-center Gaussian pump profile (xc = 140 µm) breaks the cylindrical symmetry.</p><pre><code class="language-julia hljs">dz = 1000.0
Isat = 1.0
g0m = 2e-3
wg = 30.0
xc = 140.0
gain = GainSheet(u0, dz, Isat, (x, y) -&gt; g0m * exp(-((x-xc)^2+y^2)/wg^2))

visualize(gain, identity; colormap=:inferno, show_colorbars=true, height=120)</code></pre><p><img src="../../assets/01_FoxLi_gain.png" alt="Gain profile - off-center Gaussian"/></p><h2 id="Cavity-Geometry:-Semi-Degenerate-Configuration"><a class="docs-heading-anchor" href="#Cavity-Geometry:-Semi-Degenerate-Configuration">Cavity Geometry: Semi-Degenerate Configuration</a><a id="Cavity-Geometry:-Semi-Degenerate-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Cavity-Geometry:-Semi-Degenerate-Configuration" title="Permalink"></a></h2><p>The cavity length ℓ ≈ 101 mm is close to the half-degenerate condition (ℓ = Rc/2), where the stability parameter approaches unity. This near-instability regime supports complex transverse mode structures.</p><p>We use a magnification factor of 2 between the two mirrors to properly sample the field at both ends of the cavity.</p><pre><code class="language-julia hljs">ℓ = 101000.0  # Close to half-degenerate cavity

s = 2
ds′ = s .* ds

p12 = ParaxialProp(u0, ds′, ℓ; use_cache = true)  # Magnification ×2
p21 = ParaxialProp(u0, ds′, ds, ℓ; use_cache = true)

half_cavity = gain |&gt; p12

uf = half_cavity(u0).out

visualize(uf, (intensity, complex); colormap=(:inferno, :dark), height=120)</code></pre><p><img src="../../assets/01_FoxLi_speckle_mirror.png" alt="Initial field at output mirror plane (magnified)"/></p><h2 id="Output-Coupler:-Spherical-Mirror-with-Aperture"><a class="docs-heading-anchor" href="#Output-Coupler:-Spherical-Mirror-with-Aperture">Output Coupler: Spherical Mirror with Aperture</a><a id="Output-Coupler:-Spherical-Mirror-with-Aperture-1"></a><a class="docs-heading-anchor-permalink" href="#Output-Coupler:-Spherical-Mirror-with-Aperture" title="Permalink"></a></h2><p>The output mirror has 98% reflectivity and 200 mm radius of curvature. The aperture prevents the field from overflowing the computational grid, which would lead to numerical instabilities during iteration.</p><pre><code class="language-julia hljs">R = 0.98
Rc = 200000.0
aperture_radius = 1800.0
mirror = TeaReflector(uf, (x, y) -&gt; -(x^2+y^2)/(2*Rc); r = -sqrt(R))
mirror_phase = phase(cis.(2π/λ .* get_data(mirror)))
aperture = Mask(uf, (x, y) -&gt; x^2 + y^2 &lt; aperture_radius^2 ? 1.0 : 0.0)

cavity = half_cavity |&gt; mirror |&gt; aperture |&gt; p21 |&gt; (; inplace = true)

visualize(((mirror_phase, aperture),), real; show_colorbars=true, height=120)</code></pre><p><img src="../../assets/01_FoxLi_spherical_mirror.png" alt="Spherical mirror phase profile (left) and circular aperture (right)"/></p><h2 id="Fox-Li-Iteration:-Eigenmode-Convergence"><a class="docs-heading-anchor" href="#Fox-Li-Iteration:-Eigenmode-Convergence">Fox-Li Iteration: Eigenmode Convergence</a><a id="Fox-Li-Iteration:-Eigenmode-Convergence-1"></a><a class="docs-heading-anchor-permalink" href="#Fox-Li-Iteration:-Eigenmode-Convergence" title="Permalink"></a></h2><p>We iteratively propagate the field through the complete cavity round-trip. Each iteration consists of: gain → propagation → mirror+aperture → back-propagation. After ~5000 iterations, the field converges to the cavity eigenmode.</p><pre><code class="language-julia hljs">u0c = copy(u0)
utmp = u0c

for i in 1:5000
    utmp = cavity(utmp).out
end</code></pre><h2 id="Converged-Eigenmode:-Quasi-Ince-Gaussian-IGᵉ"><a class="docs-heading-anchor" href="#Converged-Eigenmode:-Quasi-Ince-Gaussian-IGᵉ">Converged Eigenmode: Quasi-Ince-Gaussian IGᵉ₉₃</a><a id="Converged-Eigenmode:-Quasi-Ince-Gaussian-IGᵉ-1"></a><a class="docs-heading-anchor-permalink" href="#Converged-Eigenmode:-Quasi-Ince-Gaussian-IGᵉ" title="Permalink"></a></h2><p>The converged mode exhibits an elliptical intensity pattern reminiscent of Ince-Gaussian modes. This quasi-IG mode only exists near the cavity degeneracy point and maintains its structure approximately through propagation.</p><pre><code class="language-julia hljs">u_near = cavity(utmp).out
u_mirror = half_cavity(u_near).out

visualize((u_near, u_mirror), (intensity, phase);
           colormap=(:inferno, :twilight), show_colorbars=true, height=150)</code></pre><p><img src="../../assets/01_FoxLi_eigenmode.png" alt="Converged eigenmode at near field (left) and far field mirror (right)"/></p><h2 id="Far-Field-Characterization"><a class="docs-heading-anchor" href="#Far-Field-Characterization">Far-Field Characterization</a><a id="Far-Field-Characterization-1"></a><a class="docs-heading-anchor-permalink" href="#Far-Field-Characterization" title="Permalink"></a></h2><p>Propagating the eigenmode to twice the cavity length reveals the far-field intensity distribution and phase structure.</p><pre><code class="language-julia hljs">p_far = ParaxialProp(u_near, 2 .* ds, 2*ℓ; use_cache = true)
u_far = propagate(u_near, p_far, Forward)

visualize(u_far, (intensity, phase);
           colormap=(:inferno, :twilight), show_colorbars=true, height=150)</code></pre><p><img src="../../assets/01_FoxLi_far.png" alt="Far-field intensity and phase at 2ℓ distance"/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 21 October 2025 16:51">Tuesday 21 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
